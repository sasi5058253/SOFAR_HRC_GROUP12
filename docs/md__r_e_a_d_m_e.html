<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HumanRobotCollaboration: SofAR assignment - Human Robot Collaboration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HumanRobotCollaboration
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">SofAR assigment 1 - Group 1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">SofAR assignment - Human Robot Collaboration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p><b>Authors</b>: Marco Gabriele Fedozzi, Georgii Kurshakov, Laura Triglia </p>
</blockquote>
<p>This package contains part of the materials necessary to run the assignment for the <em>Software Architectures for Robotics</em> course of the Robotics Engineering/(J)EMARO MSc at <a href="https://courses.unige.it/10635">University of Genoa</a>.</p>
<p>A list of the other necessary packages are presented at the end of this document.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Compiling and Running</h1>
<p>After installing all the packages in a ROS workspace (<em>the project has been developed and tested in Noetic</em>) run </p><div class="fragment"><div class="line">.../ros_ws$ catkin_make</div>
</div><!-- fragment --><p><b>TWICE</b>, since one of the other legacy packages seems to have a dependancy issue and will throw a series of warning the first time. Ignore them, recompile, and if warnings or error still persist there might be something off with your configuration, be sure all packages are correctly installed and the ROS workspace sourced.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Baxter - Unity Simulation</h2>
<p>First of all follow the steps presented at the <b>SofAR-Human-Robot-Collaboration</b> repository (link at the end) to set up the Unity Environment. Then pass to your ROS system for the following steps. A few components need to be run, so as many separate shells should be open at the same time:</p>
<ol type="1">
<li><b>Unity - ROS connection</b> <div class="fragment"><div class="line">.../ros_ws$ roslaunch human_baxter_collaboration human_baxter_collaboration.launch</div>
</div><!-- fragment --></li>
</ol>
<p>Wait for the green text to appear, then start the Unity simulation ('Play' button). This will initiate the connection between the simulation and the ROS environment.</p>
<ol type="1">
<li><b>Finite State Machine</b> <div class="fragment"><div class="line">.../ros_ws$ roslaunch sofar_hbc_01 sofar_hbc_01.launch</div>
</div><!-- fragment --></li>
</ol>
<p>Ignore the warnings, here as well ae simply due to legacy code. Once the systems starts running you can pass to the third (optional) phase.</p>
<ol type="1">
<li><b>Collision Detection</b> (optional) <div class="fragment"><div class="line">.../ros_ws$ rosrun sofar_hbc_01 collision_detection</div>
</div><!-- fragment --></li>
</ol>
<p>This will start the node responsible of tracking collisions (better said, distances) between Baxter and the human, as well as between the two Baxter arms, in real time. This node is not necessary, and has quite a few limitations:</p><ul>
<li>the real Baxter has a low level controller that makes collisions between arms not possible. Here the detection is mainly used by the simulation, and to avoid such forced movements in the real robot;</li>
<li>no motion tracking is performed in the real scenario, hence the human tf's are only those simulated by the somewhat-limited human;</li>
<li><em>collision detection</em> does not mean <em>collision avoidance</em>: dynamic obstacles are not avoided and the plan is not modified at runtime. When a possible collision (<em>distance lower then threshold</em>) is detected, the ongoing trajectory is stopped (by sending a message to the simulation) and the <a class="el" href="class_f_s_m.html">FSM</a> is informed of type (<em>severity</em>) of the collision. <br  />
 a. **"LOW"** for human-robot collisions: being the human very mobile and relatively fast compared to the robot, the <a class="el" href="class_f_s_m.html">FSM</a> simply stops and re-plans for the previous state <br  />
 b. **"HIGH"**, for robot-robot collisions: the robot is slower, but it could repeat the same collision-prone movements if a simple replanning was asked. That's why in this case the <a class="el" href="class_f_s_m.html">FSM</a> goes into the <em>ERROR STATE</em>, bringing the arms to their initial joint states, waiting for a random (thus different for each arm) amount of time before trying to re-plan from scratch.</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Real world test</h2>
<p>The implementation of the system in a real world test does follow almost entirely the same steps already presented, since the limited system we're gonna use does rely on the simulation for the entire sensing part (minus robot proprioception). Unity simulation should be launched as in the previous case. Remember to correctly export the ROS master IP and port that will be present in the local network. The steps are thus as follows:</p>
<ol type="1">
<li><b>Unity - ROS connection</b> <div class="fragment"><div class="line">.../ros_ws$ roslaunch human_baxter_collaboration human_baxter_collaboration.launch</div>
</div><!-- fragment --></li>
<li><b>Robot Controller</b> <div class="fragment"><div class="line">.../ros_ws$ roslaunch sofar_hbc_01 joint_trajectory_client.launch</div>
</div><!-- fragment --></li>
</ol>
<p>Forward the trajectories to the actual robot.</p>
<ol type="1">
<li><b>Finite State Machine</b> <div class="fragment"><div class="line">.../ros_ws$ roslaunch sofar_hbc_01 lab_sofar_hbc_01.launch</div>
</div><!-- fragment --></li>
</ol>
<p>Launches a node which forwards the gripper commands to the robot, together with all the other nodes described.</p>
<ol type="1">
<li><b>Collision Detection</b> (optional) <div class="fragment"><div class="line">.../ros_ws$ rosrun sofar_hbc_01 collision_detection</div>
</div><!-- fragment --></li>
</ol>
<p>Might be counterproductive in the real scenario, use with care.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Other resources</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">name </th><th class="markdownTableHeadNone">link </th><th class="markdownTableHeadNone">description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">moveit_robots </td><td class="markdownTableBodyNone"><a href="https://github.com/hypothe/moveit_robots">https://github.com/hypothe/moveit_robots</a> </td><td class="markdownTableBodyNone">baxter config files for moveit (modified)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">baxter </td><td class="markdownTableBodyNone"><a href="https://github.com/RethinkRobotics/baxter">https://github.com/RethinkRobotics/baxter</a> </td><td class="markdownTableBodyNone">baxter description and interfaces (install all of the presented packages)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SofAR-Human-Robot-Collaboration </td><td class="markdownTableBodyNone"><a href="https://github.com/hypothe/SofAR-Human-Robot-Collaboration">https://github.com/hypothe/SofAR-Human-Robot-Collaboration</a> </td><td class="markdownTableBodyNone">Unity connection (modified)  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
